
# План: Увеличение лимита загрузки изображений

## Обзор
Увеличим лимит загрузки изображений с 3 МБ до 5 МБ на фронтенде и с 5 МБ до 8 МБ на бэкенде. Это учитывает увеличение размера при Base64 кодировании (~33%), обеспечивая надёжную работу.

## Почему это безопасно
- Google Gemini API поддерживает до **20 МБ** для inline images
- Base64 кодирование увеличивает размер на ~33% (5 МБ → ~6.7 МБ)
- Запас до 8 МБ на бэкенде обеспечивает надёжную работу

## Изменения

### 1. Фронтенд: Увеличение лимита до 5 МБ

**Файл: `src/components/dashboard/GenerateCards.tsx`**
- Строка 297: изменить `3 * 1024 * 1024` → `5 * 1024 * 1024`
- Строка 303: изменить текст ошибки "3 МБ" → "5 МБ"
- Строка 366: изменить `3 * 1024 * 1024` → `5 * 1024 * 1024`
- Строка 371: изменить текст ошибки "3 МБ" → "5 МБ"

**Файл: `src/components/dashboard/OptimizedGenerateCards.tsx`**
- Строка 14: изменить `3 * 1024 * 1024` → `5 * 1024 * 1024`
- Строка 135: изменить текст ошибки "3 МБ" → "5 МБ"
- Строка 205: изменить текст ошибки "3 МБ" → "5 МБ"

### 2. Бэкенд: Увеличение лимита до 8 МБ

**Файл: `supabase/functions/process-google-task/index.ts`**
- Строка 17: изменить `MAX_IMAGE_BYTES = 5_000_000` → `MAX_IMAGE_BYTES = 8_000_000`
- Обновить комментарий: `// ~8MB`

---

## Техническая информация

### Расчёт размеров
```text
Исходный файл     Base64        Запас бэкенда
    5 МБ     →    ~6.7 МБ    <    8 МБ ✓
```

### Файлы для изменения
| Файл | Тип изменения |
|------|---------------|
| `src/components/dashboard/GenerateCards.tsx` | 4 изменения (лимит + тексты) |
| `src/components/dashboard/OptimizedGenerateCards.tsx` | 3 изменения (лимит + тексты) |
| `supabase/functions/process-google-task/index.ts` | 1 изменение (константа) |

### Места проверки размера
- **Фронтенд**: Валидация при загрузке файлов (показывает toast с ошибкой)
- **Бэкенд**: Проверка при скачивании изображений перед отправкой в Gemini API
